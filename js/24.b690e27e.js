(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{8781:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{attrs:{padding:""}},[n("div",{staticClass:"row q-col-gutter-sm q-ma-xs q-mr-sm"},[n("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},[n("q-card",{attrs:{flat:"",bordered:""}},[n("q-card-section",[n("div",{staticClass:"text-h6"},[t._v("กำหนดให้ค่าคอมฯ")])]),n("q-separator",{attrs:{inset:""}}),n("q-card-section",[n("q-table",{attrs:{data:t.allagenttypes,flat:"","hide-bottom":"",columns:t.columnsagentgrouptype,separator:"cell",pagination:{rowsPerPage:0}},scopedSlots:t._u([{key:"header",fn:function(e){return[n("q-tr",{attrs:{props:e}},t._l(e.cols,(function(o){return n("q-th",{key:o.name,attrs:{props:e}},["Name"!==o.name?n("div",[n("div",{staticClass:"row justify-center"},[n("div",[t._v("\n                        "+t._s(o.label)+"\n                      ")])]),n("div",{staticClass:"row justify-center"},t._l(t.allcommissiontypes,(function(e){return n("div",{key:e.Commissiontypeid,staticClass:"col"},[n("div",{staticClass:"row justify-center"},[t._v("\n                          "+t._s(e.Name)+"\n                        ")])])})),0)]):t._e()])})),1)]}},{key:"body",fn:function(e){return[n("q-tr",{attrs:{props:e}},t._l(e.cols,(function(o){return n("q-td",{key:o.name,attrs:{props:e}},["Name"!==o.name?n("div",[n("div",{staticClass:"row justify-center"},t._l(t.allcommissiontypes,(function(a){return n("div",{key:a.Commissiontypeid,staticClass:"col"},[n("q-toggle",{attrs:{value:t.CkeckValue(e.row.Agenttypeid,parseInt(o.name),a.Commissiontypeid),"checked-icon":"done","unchecked-icon":"remove"},on:{input:function(n){t.Updatecms(e.row.Agenttypeid,parseInt(o.name),a.Commissiontypeid)}}})],1)})),0)]):n("div",[t._v("\n                    "+t._s(o.value)+"\n                  ")])])})),1)]}}])})],1)],1)],1)]),n("div",{staticClass:"row q-col-gutter-sm q-ma-xs q-mr-sm"},[n("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},[n("q-card",{attrs:{flat:"",bordered:""}},[n("q-card-section",[n("div",{staticClass:"text-h6"},[t._v("ประเภทการจ่าย")])]),n("q-separator",{attrs:{inset:""}}),n("q-card-section",[n("q-table",{attrs:{data:t.allpaymenttypes,flat:"","hide-bottom":"",columns:t.columnspaymenttype,"row-key":"Paymenttypeid",pagination:{rowPerPage:0}},scopedSlots:t._u([{key:"top-right",fn:function(){return[n("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"add"},on:{click:t.Addpaymenttype}})]},proxy:!0},{key:"header",fn:function(e){return[n("q-tr",{attrs:{props:e}},[n("q-th",{attrs:{"auto-width":""}}),t._l(e.cols,(function(o){return n("q-th",{key:o.name,attrs:{props:e}},[t._v("\n                  "+t._s(o.label)+"\n                ")])})),n("q-th",{attrs:{"auto-width":""}},[t._v("เพิ่มบรรทัด")]),n("q-th",{attrs:{"auto-width":""}},[t._v("ลบบรรทัด")]),n("q-th",{attrs:{"auto-width":""}})],2)]}},{key:"body",fn:function(e){return[n("q-tr",{attrs:{props:e}},[n("q-td",{attrs:{"auto-width":""}},[n("q-btn",{attrs:{size:"sm",color:"accent",round:"",outline:"",dense:"",icon:e.expand?"remove":"add"},on:{click:function(t){e.expand=!e.expand}}})],1),n("q-td",{attrs:{"auto-width":""}},[n("div",{staticClass:"text-pre-wrap"},[t._v(t._s(e.row.Paymenttypeid))])]),n("q-td",{attrs:{"auto-width":""}},[n("div",{staticClass:"text-pre-wrap"},[t._v(t._s(e.row.Name))]),n("q-popup-edit",{attrs:{buttons:""},on:{save:function(n){return t.Updatepaymenttypes(e.row)}},model:{value:e.row.Name,callback:function(n){t.$set(e.row,"Name",n)},expression:"props.row.Name"}},[n("q-input",{attrs:{type:"textarea",dense:"",autofocus:""},model:{value:e.row.Name,callback:function(n){t.$set(e.row,"Name",n)},expression:"props.row.Name"}})],1)],1),n("q-td",{attrs:{"auto-width":""}},[n("div",{staticClass:"row justify-center"},[n("q-toggle",{attrs:{value:1===e.row.Allownewline,"checked-icon":"done","unchecked-icon":"remove"},on:{input:function(n){1===e.row.Allownewline?e.row.Allownewline=0:e.row.Allownewline=1,t.Updatepaymenttypes(e.row)}}})],1)]),n("q-td",{attrs:{"auto-width":""}},[n("div",{staticClass:"row justify-center"},[n("q-toggle",{attrs:{value:1===e.row.Allowdeleteline,"checked-icon":"done","unchecked-icon":"remove"},on:{input:function(n){1===e.row.Allowdeleteline?e.row.Allowdeleteline=0:e.row.Allowdeleteline=1,t.Updatepaymenttypes(e.row)}}})],1)]),n("q-td",{attrs:{"auto-width":""}},[n("q-btn",{attrs:{dense:"",flat:"",outline:"",color:"red",icon:"delete"},on:{click:function(n){return t.Deletepaymenttypes(e.row)}}})],1)],1),n("q-tr",{directives:[{name:"show",rawName:"v-show",value:e.expand,expression:"props.expand"}],attrs:{props:e}},[n("q-td",{attrs:{colspan:"100%"}},[n("div",{staticClass:"row"},[n("q-list",{staticClass:"col-8 offset-1",attrs:{separator:""}},[t._l(e.row.Paymentcommission,(function(o,a){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:a,staticClass:"q-ma-none",attrs:{clickable:""}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:"attach_money",color:"warning"}})],1),n("q-item-section",[t._v(t._s(o.Commissiontype?o.Commissiontype.Name:""))]),n("q-item-section",{attrs:{avatar:""}},[n("q-btn",{attrs:{size:"md",outline:"",dense:"",icon:"delete",color:"red"},on:{click:function(n){return t.Deletepaymentcommissions(e.row,o)}}})],1)],1)})),n("q-btn",{staticClass:"q-ml-md",attrs:{round:"",size:"sm",color:"accent",icon:"add"},on:{click:function(n){return t.Selectcommissiontypes(e.row)}}},[n("q-tooltip",[t._v("เพิ่มบรรทัดค่าคอมฯ")])],1)],2)],1)])],1)]}}])})],1)],1)],1)])])},a=[],s=(n("456d"),n("8a81"),n("9986"),n("8e6e"),n("c973")),i=n.n(s),r=n("9523"),c=n.n(r),l=(n("7514"),n("20d6"),n("6d67"),n("d25f"),n("a34a")),d=n.n(l),m=n("2f62");function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"Commissionset",computed:{columnsagentgrouptype:function(){var t=[{name:"Name",label:"",align:"left",field:"Name",sortable:!0}];return this.allagentgrouptypes.forEach((function(e){t.push({name:"".concat(e.Agentgrouptypeid),label:e.Name,align:"left",sortable:!0})})),t},allcommissionseta:function(){return this.allcommissionset}},data:function(){return{allagenttypes:[],allagentgrouptypes:[],allcommissiontypes:[],allcommissionset:[],allpaymenttypes:[],columnspaymenttype:[{name:"Paymenttypeid",label:"คีย์",align:"left",field:"Paymenttypeid",sortable:!0},{name:"Name",label:"ชื่อ",align:"left",field:"Name",sortable:!0}]}},created:function(){this.LoadData()},methods:u(u({},Object(m["b"])("retailarea",["getagenttypes","getagentgrouptypes","getcommissiontypes","getcommissionsets","updatecommissionsets","getpaymenttypes","createpaymenttypes","updatepaymenttypes","deletepaymenttypes","deletepaymenttypes","createpaymentcommissions","deletepaymentcommissions"])),{},{LoadData:function(){var t=this;this.$q.loading.show(),this.getagenttypes().then((function(e){var n=e.data;return t.allagenttypes=n,t.getagentgrouptypes()})).then((function(e){var n=e.data;return t.allagentgrouptypes=n,t.getcommissiontypes()})).then((function(e){var n=e.data;return t.allcommissiontypes=n,t.getcommissionsets()})).then((function(e){var n=e.data;return t.allcommissionset=n,t.getpaymenttypes()})).then((function(e){var n=e.data;t.allpaymenttypes=n})).then((function(){t.$q.loading.hide(),t.timer=void 0}))},Updatecms:function(t,e,n){var o=this;return i()(d.a.mark((function a(){var s;return d.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o.$q.loading.show(),a.next=3,o.CkeckValue(t,e,n);case 3:s=a.sent,o.updatecommissionsets({Agenttypeid:t,Agentgrouptypeid:e,Commissiontypeid:n,Calculate:s?0:1,Modifiedby:"",Modifieddatetime:new Date}).then((function(){o.$q.notify("อัพเดทเรียบร้อย"),o.$q.loading.hide(),o.timer=void 0})).then((function(){o.LoadData()})).catch((function(t){o.$q.loading.hide(),o.timer=void 0,console.log(t.response),o.$q.notify({icon:"done",color:"red",message:t.response.data.message})}));case 5:case"end":return a.stop()}}),a)})))()},CkeckValue:function(t,e,n){var o=this.allcommissionset.find((function(o){return o.Agenttypeid===t&&o.Agentgrouptypeid===e&&o.Commissiontypeid===n}));return!!o&&1===o.Calculate},Addpaymenttype:function(){var t=this,e=this;e.$q.dialog({title:"เพิ่มประเภทใบสั่งจ่าย",message:"ระบุชื่อเรียก",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((function(e){""!==e&&t.Createpaymenttypes({Paymenttypeid:0,Name:e})}))},Createpaymenttypes:function(t){var e=this;this.$q.loading.show(),this.createpaymenttypes(t).then((function(t){t.status;var n=t.data;e.allpaymenttypes.push(n),e.$q.notify("อัพเดทเรียบร้อย"),e.$q.loading.hide(),e.timer=void 0})).catch((function(t){e.$q.loading.hide(),e.timer=void 0,console.log(t.response),e.$q.notify({icon:"done",color:"red",message:t.response.data.message})}))},Updatepaymenttypes:function(t){var e=this;this.$q.loading.show(),this.updatepaymenttypes(t).then((function(){e.$q.notify("อัพเดทเรียบร้อย"),e.$q.loading.hide(),e.timer=void 0})).catch((function(t){e.$q.loading.hide(),e.timer=void 0,console.log(t.response),e.$q.notify({icon:"done",color:"red",message:t.response.data.message})}))},Deletepaymenttypes:function(t){var e=this;this.$q.loading.show(),this.deletepaymenttypes(t).then((function(t){var n=t.data;e.allpaymenttypes.splice(e.allpaymenttypes.findIndex((function(t){return t.Paymenttypeid===n.Paymenttypeid})),1),e.$q.notify("อัพเดทเรียบร้อย"),e.$q.loading.hide(),e.timer=void 0})).catch((function(t){e.$q.loading.hide(),e.timer=void 0,console.log(t.response),e.$q.notify({icon:"done",color:"red",message:t.response.data.message})}))},Selectcommissiontypes:function(t){var e=this;this.$q.dialog({title:"เลือกค่าคอมฯ",message:"เลือกบรรทัดค่าคอมฯเริ่มต้น",options:{type:"radio",model:"",items:this.allcommissiontypes.filter((function(e){return!t.Paymentcommission.find((function(t){return t.Commissiontypeid===e.Commissiontypeid}))})).map((function(t){return{label:t.Name,value:t.Commissiontypeid}}))},cancel:!0,persistent:!0}).onOk((function(n){e.$q.loading.show(),e.createpaymentcommissions({Paymenttypeid:t.Paymenttypeid,Commissiontypeid:n}).then((function(n){n.status;var o=n.data;t.Paymentcommission.push(o),e.$q.notify("อัพเดทเรียบร้อย"),e.$q.loading.hide(),e.timer=void 0})).catch((function(t){e.$q.loading.hide(),e.timer=void 0,console.log(t.response),e.$q.notify({icon:"done",color:"red",message:t.response.data.message})}))}))},Deletepaymentcommissions:function(t,e){var n=this;this.$q.loading.show(),this.deletepaymentcommissions(e).then((function(o){o.data;var a=t.Paymentcommission.findIndex((function(t){return t.Paymenttypeid===e.Paymenttypeid&&t.Commissiontypeid===e.Commissiontypeid}));t.Paymentcommission.splice(a,1),n.$q.notify("อัพเดทเรียบร้อย"),n.$q.loading.hide(),n.timer=void 0})).catch((function(t){n.$q.loading.hide(),n.timer=void 0,console.log(t.response),n.$q.notify({icon:"done",color:"red",message:t.response.data.message})}))}})},f=y,g=n("2877"),h=n("9989"),v=n("f09f"),q=n("a370"),w=n("eb85"),b=n("eaac"),C=n("bd08"),k=n("357e"),$=n("db86"),_=n("9564"),P=n("9c40"),x=n("42a1"),O=n("27f9"),N=n("1c1c"),j=n("66e5"),A=n("4074"),Q=n("0016"),D=n("05c0"),S=n("714f"),I=n("eebe"),T=n.n(I),U=Object(g["a"])(f,o,a,!1,null,null,null);e["default"]=U.exports;T()(U,"components",{QPage:h["a"],QCard:v["a"],QCardSection:q["a"],QSeparator:w["a"],QTable:b["a"],QTr:C["a"],QTh:k["a"],QTd:$["a"],QToggle:_["a"],QBtn:P["a"],QPopupEdit:x["a"],QInput:O["a"],QList:N["a"],QItem:j["a"],QItemSection:A["a"],QIcon:Q["a"],QTooltip:D["a"]}),T()(U,"directives",{Ripple:S["a"]})}}]);