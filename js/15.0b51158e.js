(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"7f10":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row q-col-gutter-sm q-ma-xs q-mr-sm"},[a("div",{staticClass:"col-lg-4 col-md-4 col-sm-12 col-xs-12"},[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("เพิ่ม/แก้ไข")])]),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[a("q-list",[a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"q-pb-xs"},[e._v("คีย์")]),a("q-input",{attrs:{dense:"",outlined:"",readonly:"",label:"คีย์"},model:{value:e.currentuser.Id,callback:function(t){e.$set(e.currentuser,"Id",t)},expression:"currentuser.Id"}})],1)],1),a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"q-pb-xs"},[e._v("อีเมล์")]),a("q-input",{attrs:{dense:"",outlined:"",type:"email",label:"อีเมล์"},model:{value:e.currentuser.Email,callback:function(t){e.$set(e.currentuser,"Email",t)},expression:"currentuser.Email"}})],1)],1),a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"q-pb-xs"},[e._v("รหัสผู้ใช้")]),a("q-input",{attrs:{dense:"",outlined:"",label:"รหัสผู้ใช้"},model:{value:e.currentuser.UserName,callback:function(t){e.$set(e.currentuser,"UserName",t)},expression:"currentuser.UserName"}})],1)],1),a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"q-pb-xs"},[e._v("ชื่อผู้ใช้")]),a("q-input",{attrs:{dense:"",outlined:"",label:"ชื่อผู้ใช้"},model:{value:e.currentuser.Name,callback:function(t){e.$set(e.currentuser,"Name",t)},expression:"currentuser.Name"}})],1)],1),a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"q-pb-xs"},[e._v("โทร")]),a("q-input",{attrs:{dense:"",outlined:"",label:"โทร"},model:{value:e.currentuser.PhoneNumber,callback:function(t){e.$set(e.currentuser,"PhoneNumber",t)},expression:"currentuser.PhoneNumber"}})],1)],1)],1)],1),a("q-card-actions",{staticClass:"q-mr-md"},[e.modeadd?e._e():a("q-btn",{staticClass:"q-pl-md q-pr-md",attrs:{outline:"",label:"รีเซ็ตรหัสผ่าน",color:"red",disable:!e.currentuser.Email},on:{click:function(t){return e.Resetpassword(e.currentuser)}}}),a("q-space"),e.modeadd?a("q-btn",{staticClass:"q-pl-md q-pr-md",attrs:{outline:"",label:"เพิ่ม",color:"primary",disable:!e.currentuser.Email},on:{click:function(t){return e.Createuser(e.currentuser)}}}):a("q-btn",{staticClass:"q-pl-md q-pr-md",attrs:{outline:"",label:"อัพเดท",color:"primary",disable:!e.currentuser.Email},on:{click:function(t){e.updateuser(e.currentuser).then((function(){return e.$q.notify("อัพเดทเรียบร้อย")}))}}})],1)],1)],1),a("div",{staticClass:"col-lg-8 col-md-8 col-sm-12 col-xs-12"},[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("ผู้ใช้")])]),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[a("q-table",{staticClass:"full-width my-sticky-header-column-table",attrs:{data:e.alluser,flat:"","hide-header":"grid"===e.mode,columns:e.columnsuser,selection:"single",selected:e.selected,"row-key":"Id",filter:e.filter,grid:"grid"==e.mode,pagination:e.pagination,separator:"horizontal"},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top-right",fn:function(t){return[a("q-input",{attrs:{borderless:"",dense:"",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),"list"===e.mode?a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}},[a("q-tooltip",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:e.$q.platform.is.mobile}},[e._v(e._s(t.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"))])],1):e._e(),t.inFullscreen?e._e():a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"grid"===e.mode?"list":"grid_on"},on:{click:function(t){e.mode="grid"===e.mode?"list":"grid",e.separator="grid"===e.mode?"none":"horizontal"}}},[a("q-tooltip",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:e.$q.platform.is.mobile}},[e._v(e._s("grid"===e.mode?"List":"Grid"))])],1)]}},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{attrs:{"auto-width":""}},[a("q-checkbox",{attrs:{size:"sm",color:"accent",value:!!e.selected.find((function(e){return e.Id===t.row.Id}))},on:{input:function(a){e.selected.find((function(e){return e.Id===t.row.Id}))?e.selected=[]:e.selected=[t.row]}}})],1),e._l(t.cols,(function(r){return a("q-td",{key:r.name,attrs:{props:t}},["Selectgroup"===r.name?a("div",[a("q-btn",{attrs:{size:"sm",color:"accent",round:"",outline:"",dense:"",icon:t.expand?"remove":"add"},on:{click:function(e){t.expand=!t.expand}}},[a("q-tooltip",[e._v("จัดกลุ่มผู้ใช้")])],1)],1):"Blocked"===r.name?a("div",[a("q-btn",{attrs:{size:"sm",round:"",dense:""},on:{click:function(a){t.row.Blocked=!t.row.Blocked,e.updateuser(t.row).then((function(){return e.$q.notify("อัพเดทเรียบร้อย")}))}}},[a("q-icon",{attrs:{name:t.row.Blocked?"clear":"check",color:t.row.Blocked?"red":"green"}}),a("q-tooltip",[e._v("ปรับสถานะใช้งาน")])],1)],1):"UserName"===r.name?a("div",[a("q-badge",{attrs:{color:"primary"}},[e._v("\n                      "+e._s(t.row.UserName)+"\n                    ")])],1):a("div",[e._v(e._s(r.value))])])}))],2),a("q-tr",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"props.expand"}],attrs:{props:t}},[a("q-td",{attrs:{colspan:"100%"}},[a("div",{staticClass:"row"},[a("q-list",{staticClass:"col-8 offset-1",attrs:{separator:""}},[e._l(t.row.Usergroupbackoffice,(function(r,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,staticClass:"q-ma-none",attrs:{clickable:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"vpn_key",color:"warning"}})],1),a("q-item-section",[e._v(e._s(r.Group.Name))]),a("q-item-section",{attrs:{avatar:""}},[a("q-btn",{attrs:{size:"md",outline:"",dense:"",icon:"delete",color:"red"},on:{click:function(a){return e.DeleteUsergroupBackoffice(t.row,r)}}})],1)],1)})),a("q-item",[a("q-space"),a("q-item-section",{attrs:{avatar:""}},[a("q-btn",{attrs:{round:"",size:"sm",color:"accent",icon:"add"},on:{click:function(a){return e.SelectUsergroup(t)}}},[a("q-tooltip",[e._v("จัดกลุ่มผู้ใช้ (back-office)")])],1)],1)],1)],2)],1)])],1)]}},{key:"pagination",fn:function(){return[a("div",[a("q-pagination",{attrs:{size:"sm",color:"black",max:e.pagination.MaxPage,"max-pages":4,"boundary-numbers":!1},model:{value:e.pagination.Page,callback:function(t){e.$set(e.pagination,"Page",t)},expression:"pagination.Page"}})],1)]},proxy:!0}])})],1)],1)],1)])])},n=[],o=(a("456d"),a("8a81"),a("9986"),a("8e6e"),a("9523")),s=a.n(o),i=(a("6d67"),a("f751"),a("d25f"),a("7514"),a("20d6"),a("2f62"));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=function(){return{Email:"",UserName:"",Password:"123456",PhoneNumber:"",Blocked:!1,Name:""}},u={name:"User",data:function(){return{modeadd:!0,mode:"list",pagination:{Page:1,MaxPage:1,page:1,rowsPerPage:10},filter:"",alluser:[],selected:[],currentuser:d(),columnsuser:[{name:"Selectgroup",field:"Selectgroup"},{name:"Blocked",field:"Blocked",align:"center"},{name:"UserName",label:"รหัสผู้ใช้",align:"left",field:"UserName",sortable:!0},{name:"Email",label:"อีเมล์",align:"left",field:"Email",sortable:!0},{name:"Name",label:"ชื่อ",align:"left",field:"Name",sortable:!0},{name:"PhoneNumber",label:"โทร",align:"left",field:"PhoneNumber",sortable:!0}]}},created:function(){this.LoadData(this.pagination)},methods:l(l({},Object(i["b"])("auth",["getuserpagination","createuser","updateuser","getusergroup","createusergroupbackoffice","deleteusergroupbackoffice","userresetpassword"])),{},{LoadData:function(e){var t=this;this.$q.loading.show(),this.getuserpagination({page:e.Page,rowperpage:e.rowsPerPage}).then((function(e){var a=e.status,r=e.data;200===a&&(t.alluser=r.Data.map((function(e){return e.Name=e.Userinfo?e.Userinfo.Name:"",e.Blocked=!!e.Userinfo&&e.Userinfo.Blocked,e})),t.pagination.MaxPage=r.MaxPage,t.$q.loading.hide(),t.timer=void 0)})).catch((function(e){t.$q.loading.hide(),t.timer=void 0,console.log(e.response),t.$q.notify({icon:"done",color:"red",message:e.response.data.message})}))},Createuser:function(e){var t=this;this.$q.loading.show(),this.createuser(e).then((function(e){var a=e.status,r=e.data;200===a&&(t.alluser.unshift(Object.assign({},r,{Name:r.Userinfo.Name,Blocked:r.Userinfo.Blocked})),t.$q.notify("เพิ่มเรียบร้อย")),t.$q.loading.hide(),t.timer=void 0})).catch((function(e){t.$q.loading.hide(),t.timer=void 0,console.log(e.response),t.$q.notify({icon:"done",color:"red",message:e.response.data.message})}))},SelectUsergroup:function(e){var t=this;this.getusergroup().then((function(a){var r=a.data;t.$q.dialog({title:"เลือกกลุ่ม",message:"เลือกกลุ่มที่ต้องการเพิ่มให้กลับผู้ใช้ปัจจุบัน",options:{type:"radio",model:"",items:r.filter((function(t){return!e.row.Usergroupbackoffice.find((function(e){return e.Groupid===t.Groupid}))})).map((function(e){return{label:e.Name,value:e.Groupid}}))},cancel:!0,persistent:!0}).onOk((function(a){t.createusergroupbackoffice({Groupid:a,Userid:e.row.Id}).then((function(t){var a=t.data;e.row.Usergroupbackoffice.push(a)}))}))}))},DeleteUsergroupBackoffice:function(e,t){var a=this;this.$q.loading.show(),this.deleteusergroupbackoffice(t).then((function(t){var r=t.status,n=t.data;if(200===r){var o=e.Usergroupbackoffice.findIndex((function(e){return e.Groupid===n.Groupid&&e.Userid===n.Userid}));e.Usergroupbackoffice.splice(o,1)}a.$q.loading.hide(),a.timer=void 0})).catch((function(e){a.$q.loading.hide(),a.timer=void 0,console.log(e.response),a.$q.notify({icon:"done",color:"red",message:e.response.data.message})}))},Resetpassword:function(e){var t=this;this.$q.loading.show(),this.userresetpassword({Id:e.Id,Newpassword:"123456"}).then((function(){t.$q.loading.hide(),t.timer=void 0,t.$q.notify({icon:"done",color:"primary",message:"สำเร็จ"})})).catch((function(e){t.$q.loading.hide(),t.timer=void 0,console.log(e.response),t.$q.notify({icon:"done",color:"red",message:e.response.data.message})}))}}),watch:{"pagination.Page":function(e,t){this.LoadData(this.pagination)},"pagination.rowsPerPage":function(){1===this.pagination.Page?this.LoadData(this.pagination):this.pagination.Page=1},selected:function(e){e.length>0?(this.modeadd=!1,this.currentuser=e[0]):(this.modeadd=!0,this.currentuser=d())}}},p=u,m=a("2877"),f=a("9989"),g=a("f09f"),b=a("a370"),q=a("eb85"),h=a("1c1c"),v=a("66e5"),k=a("4074"),w=a("0170"),y=a("27f9"),x=a("4b7e"),P=a("9c40"),_=a("2c91"),N=a("eaac"),$=a("0016"),U=a("05c0"),C=a("bd08"),O=a("db86"),Q=a("8f8e"),I=a("58a8"),B=a("3b16"),j=a("7f67"),S=a("714f"),E=a("eebe"),D=a.n(E),z=Object(m["a"])(p,r,n,!1,null,null,null);t["default"]=z.exports;D()(z,"components",{QPage:f["a"],QCard:g["a"],QCardSection:b["a"],QSeparator:q["a"],QList:h["a"],QItem:v["a"],QItemSection:k["a"],QItemLabel:w["a"],QInput:y["a"],QCardActions:x["a"],QBtn:P["a"],QSpace:_["a"],QTable:N["a"],QIcon:$["a"],QTooltip:U["a"],QTr:C["a"],QTd:O["a"],QCheckbox:Q["a"],QBadge:I["a"],QPagination:B["a"]}),D()(z,"directives",{ClosePopup:j["a"],Ripple:S["a"]})}}]);